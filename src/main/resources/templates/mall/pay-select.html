<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head th:replace="mall/header::head-fragment('mall-selpayment','pay-select')">
</head>
<body>
<div class="page-main">
    <div class="container confirm-box">
        <form target="_blank" action="#" id="J_payForm" method="post">
            <div class="section section-order">
                <div class="order-info clearfix">
                    <div class="fl">
                        <h2 class="title">Orders submitted successfully!</h2>
                        <input type="hidden" id="orderNoValue" th:value="${orderNo}">
                        <p class="order-time" id="J_deliverDesc">Order No：
                            <th:block th:text="${orderNo}"></th:block>
                        </p>
                    </div>
                    <div class="fr">
                        <p class="total">
                            Total：<span class="money"><em><th:block
                                th:text="${totalPrice+'.00'}"></th:block></em></span>
                        </p>
                    </div>
                </div>
            </div>
            <div class="section section-payment">
                <div class="cash-title" id="J_cashTitle">
                    Choose the following payment method to pay
                </div>

                <div class="payment-box ">
                    <div class="payment-header clearfix">
                        <h3 class="title">Payment Platform</h3>
                        <span class="desc"></span>
                    </div>
                    <div class="payment-body">
                        <ul class="clearfix payment-list J_paymentList J_linksign-customize">
                            <li class="J_alipay">
                                <!--onclick="payOrder(1)" -->
                                <input type="radio" name="payOnlineBank" value="paytmpay">
                                <img th:src="@{/mall/image/pay/paytmpay.jpg}" alt="paytm"></li>
                            <li class="J_alipay">
                                <!--onclick="payOrder(1)" -->
                                <input type="radio" name="payOnlineBank" value="upipay">
                                <img th:src="@{/mall/image/pay/upipay.png}" alt="upi"></li>
                            <!--<li class="J_alipay">-->
                                <!--<input type="radio" name="payOnlineBank" id="alipay" value="alipay">-->
                                <!--<img onclick="payOrder(1)" th:src="@{/mall/image/pay/payOnline_zfb.png}" alt="支付宝"-->
                                     <!--style="margin-left: 0;"></li>-->
                            <!--<li id="J_weixin">-->
                                <!--<input type="radio" name="payOnlineBank" id="alipay" value="alipay">-->
                                <!--<img onclick="payOrder(2)" th:src="@{/mall/image/pay/weixinpay.png}" alt="微信支付"-->
                                     <!--style="margin-left: 0;">-->
                            <!--</li>-->
                            <!--<li class="J_bank">-->
                                <!--<input type="radio" name="payOnlineBank" id="unionpay" value="unionpay">-->
                                <!--<img th:src="@{/mall/image/pay/unionpay.png}" alt="银联"-->
                                     <!--style="margin-left: 0;">-->
                            <!--</li>-->
                        </ul>
                    </div>
                    <div class="payment-btn" onclick="payfor()">Confirm</div>
                </div>

                <!--<div class="payment-box">-->
                    <!--<div class="payment-header clearfix">-->
                        <!--<h3 class="title">Bank debit and credit cards</h3>-->
                    <!--</div>-->
                    <!--<div class="payment-body">-->
                        <!--<ul class="clearfix payment-list payment-list-much J_paymentList J_linksign-customize">-->
                            <!--<li class="J_bank">-->
                                <!--<input type="radio" name="payOnlineBank" id="CMB" value="CMB">-->
                                <!--<img th:src="@{/mall/image/pay/payOnline_zsyh.png}" alt="">-->
                            <!--</li>-->
                            <!--<li class="J_bank">-->
                                <!--<input type="radio" name="payOnlineBank" id="ICBCB2C" value="ICBCB2C">-->
                                <!--<img th:src="@{/mall/image/pay/payOnline_gsyh.png}" alt=""></li>-->
                            <!--<li class="J_bank">-->
                                <!--<input type="radio" name="payOnlineBank" id="CCB" value="CCB">-->
                                <!--<img th:src="@{/mall/image/pay/payOnline_jsyh.png}" alt="">-->
                            <!--</li>-->
                            <!--<li class="J_bank">-->
                                <!--<input type="radio" name="payOnlineBank" id="COMM" value="COMM">-->
                                <!--<img th:src="@{/mall/image/pay/payOnline_jtyh.png}" alt="">-->
                            <!--</li>-->
                            <!--<li class="J_bank">-->
                                <!--<input type="radio" name="payOnlineBank" id="ABC" value="ABC">-->
                                <!--<img th:src="@{/mall/image/pay/payOnline_nyyh.png}" alt=""></li>-->
                            <!--<li class="J_bank">-->
                                <!--<input type="radio" name="payOnlineBank" id="BOCB2C" value="BOCB2C">-->
                                <!--<img th:src="@{/mall/image/pay/payOnline_zgyh.png}" alt="">-->
                            <!--</li>-->
                            <!--<li class="J_bank">-->
                                <!--<input type="radio" name="payOnlineBank" id="PSBC-DEBIT" value="PSBC-DEBIT">-->
                                <!--<img th:src="@{/mall/image/pay/payOnline_youzheng.png}" alt="">-->
                            <!--</li>-->
                            <!--<li class="J_bank">-->
                                <!--<input type="radio" name="payOnlineBank" id="GDB" value="GDB">-->
                                <!--<img th:src="@{/mall/image/pay/payOnline_gfyh.png}" alt="">-->
                            <!--</li>-->
                            <!--<li class="J_bank">-->
                                <!--<input type="radio" name="payOnlineBank" id="SPDB" value="SPDB">-->
                                <!--<img th:src="@{/mall/image/pay/payOnline_pufa.png}" alt="">-->
                            <!--</li>-->
                            <!--<li class="J_bank">-->
                                <!--<input type="radio" name="payOnlineBank" id="CEBBANK" value="CEBBANK">-->
                                <!--<img th:src="@{/mall/image/pay/payOnline_gdyh.png}" alt="">-->
                            <!--</li>-->
                            <!--<li class="J_bank">-->
                                <!--<input type="radio" name="payOnlineBank" id="CIB" value="CIB">-->
                                <!--<img th:src="@{/mall/image/pay/payOnline_xyyh.png}" alt="">-->
                            <!--</li>-->
                        <!--</ul>-->
                    <!--</div>-->
                <!--</div>-->

                <!--<div class="payment-box payment-box-last ">-->
                    <!--<div class="payment-header clearfix">-->
                        <!--<h3 class="title">Quick payment</h3>-->
                        <!--<span class="desc">（支持以下各银行信用卡以及部分银行借记卡）</span>-->
                    <!--</div>-->
                    <!--<div class="payment-body">-->
                        <!--<ul class="clearfix payment-list  J_paymentList J_linksign-customize">-->
                            <!--<li class="J_bank">-->
                                <!--<input type="radio" name="payOnlineBank" id="CMB-KQ" value="CMB-KQ"> <img-->
                                    <!--th:src="@{/mall/image/pay/payOnline_zsyh.png}" alt=""></li>-->
                            <!--<li class="J_bank">-->
                                <!--<input type="radio" name="payOnlineBank" id="COMM-KQ" value="COMM-KQ"> <img-->
                                    <!--th:src="@{/mall/image/pay/payOnline_jtyh.png}" alt=""></li>-->
                            <!--<li class="J_bank">-->
                                <!--<input type="radio" name="payOnlineBank" id="CCB-KQ" value="CCB-KQ"> <img-->
                                    <!--th:src="@{/mall/image/pay/payOnline_jsyh.png}" alt=""></li>-->
                            <!--<li class="J_bank">-->
                                <!--<input type="radio" name="payOnlineBank" id="ICBCB2C-KQ" value="ICBCB2C-KQ"> <img-->
                                    <!--th:src="@{/mall/image/pay/payOnline_gsyh.png}" alt=""></li>-->
                            <!--<li class="J_bank">-->
                                <!--<input type="radio" name="payOnlineBank" id="CITIC-KQ" value="CITIC-KQ"> <img-->
                                    <!--th:src="@{/mall/image/pay/payOnline_zxyh.png}" alt=""></li>-->
                            <!--<li class="J_bank">-->
                                <!--<input type="radio" name="payOnlineBank" id="CEBBANK-KQ" value="CEBBANK-KQ"> <img-->
                                    <!--th:src="@{/mall/image/pay/payOnline_gdyh.png}" alt=""></li>-->
                            <!--<li class="J_bank">-->
                                <!--<input type="radio" name="payOnlineBank" id="BOCB2C-KQ" value="BOCB2C-KQ"> <img-->
                                    <!--th:src="@{/mall/image/pay/payOnline_zgyh.png}" alt=""></li>-->
                            <!--<li class="J_bank">-->
                                <!--<input type="radio" name="payOnlineBank" id="SRCB-KQ" value="SRCB-KQ"> <img-->
                                    <!--th:src="@{/mall/image/pay/payOnline_shncsyyh.png}" alt=""></li>-->
                            <!--<li class="J_bank">-->
                                <!--<input type="radio" name="payOnlineBank" id="JSB-KQ" value="JSB-KQ"> <img-->
                                    <!--th:src="@{/mall/image/pay/payOnline_jiangsshuyh.png}" alt=""></li>-->
                            <!--<li class="J_bank">-->
                                <!--<input type="radio" name="payOnlineBank" id="CIB-KQ" value="CIB-KQ"> <img-->
                                    <!--th:src="@{/mall/image/pay/payOnline_xyyh.png}" alt=""></li>-->
                        <!--</ul>-->
                    <!--</div>-->
                <!--</div>-->
            </div>
        </form>
    </div>
    <div id="payBox" class="hide"></div>
</div>

<div th:replace="mall/footer::footer-fragment"></div>

<!-- jQuery -->
<script th:src="@{/admin/plugins/jquery/jquery.min.js}"></script>
<script th:src="@{/admin/plugins/sweetalert/sweetalert.min.js}"></script>
<script type="text/javascript">
    //给出提醒
    $('.J_bank').click(function () {
        alert('Not currently supported');
    })

    $('li.J_alipay').on('click',function(){
        $(this).addClass('curr').siblings().removeClass('curr');
    });

    function payReady(form) {
        // console.log(form);
        var el = document.getElementById("ttmallPay");
        if (!el) {
            var div = document.createElement("div");
            div.setAttribute("id", "ttmallPay");
            div.style.display = "none";
            div.innerHTML = form;
            document.body.appendChild(div);
        } else el.innerHTML = form;
        //提交
        setTimeout(function(){
            var forms = document.forms["paytm"];
            if (forms.length > 0)
                forms.submit();
        },10)
    }

    function payfor(){
        var lens = $('li.J_alipay.curr').length;
        if(lens == 0){
            swal({
                text: "Please select mode of payment",
                icon: "warning"
            });
            return;
        }
        swal({
            text: "Confirm to pay?",
            icon: "info",
            buttons: ["Cancel","Confirm"]
        }).then((flag) => {
            console.log(flag);
            if (flag) {
                $.ajax({
                    type: "POST",
                    url: "/pay/orderPay",
                    contentType: "application/json",
                    data: {}, //参数
                    success: function (res) {
                        console.log(res);
                        if (res.resultCode == 200) {
                            var data = res.data;
                            swal({
                                text: "Please wait for payment"
                            });
                            this.payReady(data.webPage);
                            // swal("pay successful", {
                            //     icon: "success",
                            // });
                        } else {
                            swal('pay error', {
                                icon: "error",
                            });
                        }
                    },
                    error:function(err){
                        swal('pay error', {
                            icon: "error",
                        });
                    }
                });
            }
        });

       // window.location.href = '/orders';
    }

    function payOrder(payType) {
        var orderNo = $("#orderNoValue").val();
        window.location.href = '/payPage?orderNo=' + orderNo + "&payType=" + payType;
    }
</script>
</body>
</html>